# learning-spring-data

This folder contains different projects with basic examples of use of _spring-data_. They are not extensive example, just enought to get a project up and running, and basic tests. Some notes about library versions conflicts, etc are also provided.

## Fictional scenario

We are trying to create all the examples rnning in the same scenario: that is, a fictional Order Management System. In this system, we have basically 2 entities:

 * Order: A purchase order by a customer. An Order have one or more Items and other attributes
 * Item: Each one of the Products includeed in one customer's orders.

> Additional notes to the individual projects will be provided either here in this _README.MD_, or in more specific files withint the individual projects.

## Structure of the Projects
 * Spring-boot-cassandraDB: A spring Boot applications that uses Cassandra
 * Spring-data-cassandraDB: A spring application (without Bot) that uses Cassandra. Same funtionality as the previous one, but with slightly differences in terms of configuration or dependency versions.
 * spring-data-mongDO: A small project with MongoDB

## Notes about the Cassandra Projects

We are providing 2 Cassandra Proejcts: one of them using _Spring-Boot_, and another using _Spring Data_, but without _Spring Boot_.

Weve come accross **a lot** of problems related to dependencies version conflicts. At it happens, the versions used in our _build.gradle_ file are quite sensitive. Below wea re providing some configurations that we've proved they workk right:

### Configuration using embedded Casandra DB, but older version of Spring-data

The following dependencies work fine, but they are based on a version of _Spring-data_ that does NOT provide sme futures, like autogenerated repository methods, and others:

```
// testing...
testCompile 'junit:junit:4.13-beta-2'
testCompile 'org.springframework:spring-test:4.3.22.RELEASE'

// embedded CassandraDB...
testCompile 'org.cassandraunit:cassandra-unit-spring:2.1.9.2'
testCompile 'org.cassandraunit:cassandra-unit-shaded:2.1.9.2'
testCompile 'org.hectorclient:hector-core:2.0-0'
```

### Configuration using embedded Cassandra DB, and newer version of Spring-data, with Spring-Boot

The following dependencies work fine with Spring Boot and a newer versions of _Sring data_, where we acan use more features like autgenerated methods for our Repositories:

```
plugins {
	id 'org.springframework.boot' version '2.0.6.RELEASE'
	id 'java'
}
...
dependencies {

	implementation 'org.springframework.boot:spring-boot-starter-data-cassandra:2.0.6.RELEASE'
	implementation 'com.datastax.cassandra:cassandra-driver-core:3.1.1'
	implementation 'com.google.guava:guava:19.0'

	// testing...
	testImplementation 'org.springframework.boot:spring-boot-starter-test:2.0.6.RELEASE'

	// embedded CassandraDB for testing...
	testCompile 'org.cassandraunit:cassandra-unit-spring:3.5.0.1'
}
```

### Configuration using embedded Cassandra DB, and newer version of Spring-data, **WITHOUT** Spring-Boot

This configuration works the same as the previous one, but without _Spring Boot_:

```
dependencies {
	implementation 'org.springframework:spring-core:4.3.22.RELEASE'
	implementation 'org.springframework.data:spring-data-cassandra:2.0.6.RELEASE'
	implementation 'com.datastax.cassandra:cassandra-driver-core:3.1.1'

	// testing...
	testCompile 'junit:junit:4.13-beta-2'
	testCompile 'org.springframework:spring-test:4.3.22.RELEASE'

	// embedded CassandraDB...
	testCompile 'org.cassandraunit:cassandra-unit-spring:3.5.0.1'

}
```

### Error "_no libsigar-universal64-macosx.dylib in java.library.path_" in MAC

In the Cassandra project, we might come accross the error "no libsigar-universal64-macosx.dylib in java.library.path". This is due to some third-arty libraries In order to fix it, we need to:

* get the missing JAR. We can download it from here:
[https://es.osdn.net/projects/sfnet_sigar/downloads/sigar/1.6/hyperic-sigar-1.6.4.zip/](https://es.osdn.net/projects/sfnet_sigar/downloads/sigar/1.6/hyperic-sigar-1.6.4.zip/)

* Extract the file, get the "libsigar-universal64-macosx.dylib" and paste it into the right folder.
In order to find the right folder, we need to know the value of the system variable "_java.library.path_". In our case, we have print its value with a simpe java main program. Then, we need to copy the file in there. Actually, the value of the property "_java.library.path_" is a list of different paths. We dont have write rights in all of them, so we choose the one where we can save the file and just do it. After that, the error should be gone.